# AI Data Extractor from Documents 0.1.0

AI Data Extractor from Documents разработан для извлечения, структурирования и формализации данных из тендерной документации и других бизнес-документов. Проще говоря, программа берёт «сложный текстовый документ» и превращает его в аккуратную таблицу данных в формате JSON. Например, из тендерного файла можно автоматически вытащить номер процедуры, начальную цену (НМЦК), сроки поставки, сумму обеспечения или требования к участникам. Список этих полей хранится в специальном файле — **промпте**. При необходимости его можно отредактировать, добавив или убрав нужные пункты. Благодаря этому даже пользователи без навыков программирования могут адаптировать инструмент под свои задачи.

Программа предоставляет два варианта использования:

* графический интерфейс (GUI), где всё делается через простое окно;
* командную строку (CLI), удобную для автоматизации и интеграции с другими системами.

---

## Возможности

* Загружает документы и автоматически извлекает из них ключевые данные.
* Отслеживает прогресс загрузки и извлечения, показывая пользователю, что происходит.
* Может сохранять журнал работы (логи) и результаты в виде файлов JSON для последующего анализа.

---

## Функции

* Удобный графический интерфейс (`app/main.py`) для загрузки файлов и просмотра результатов.
* Командная строка (`cli.py`) для автоматизированного запуска и интеграции в бизнес-процессы.
* Возможность сохранять результаты работы в отдельные файлы через параметр `--save-dir`.
* Все настройки собраны в одном месте — `infra/config.py`.

---

## Начало работы

1. Создайте и активируйте виртуальное окружение:

   ```bash
   python -m venv .venv
   .venv\Scripts\activate
   ```
2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

---

## Запуск GUI

```bash
python app/main.py
```

Откроется окно, где можно выбрать документы, следить за прогрессом и сразу увидеть извлечённые данные.

Пример интерфейса GUI:

![GUI Example](docs/images/gui_example.png)

На скриншоте видно: поле для выбора файлов, индикатор прогресса и окно вывода извлечённых данных.

---

## Запуск CLI

```bash
python cli.py <file1> <file2> ...
```

Основные параметры:

* `--no-wait-index` — загрузить документы и выйти, не дожидаясь завершения анализа.
* `--save-dir <путь>` — сохранить результат в виде отдельного файла.

В командной строке показываются сообщения о ходе работы и итоговый результат. Код возврата сообщает об успехе или ошибке.

---

## Логирование и артефакты

* Все действия записываются в файл `results/logs/vector_store_journal.jsonl`.
* При использовании `--save-dir` программа создаёт копию результата и сохраняет её на диск.

---

## Промпт-активы

* Системный промпт по умолчанию для извлечения данных находится в `prompts/tender_extractor_system.prompt.md`.
* Его можно редактировать, меняя список полей для анализа документов, без изменения кода.

---

## Внешние интеграции

* Инструмент можно подключать к Excel, PowerShell, VBA и другим системам.
* В будущем будут добавлены готовые примеры интеграции с Excel и no-code платформами.

---

## Упаковка (опционально)

Чтобы программа работала на компьютере без установленного Python, можно собрать её в один файл с помощью PyInstaller:

```bash
pyinstaller --onefile cli.py
```

После этого готовый исполняемый файл появится в папке `dist`.

---

## Примечания к выпуску

**Версия 0.1.0**

* Реализован графический интерфейс и командная строка.
* Добавлены логирование, коды завершения и сохранение JSON.
* Настройки вынесены в отдельный конфигурационный файл.

---

## Следующие шаги

* Подготовить готовые примеры интеграций (Excel, webhooks).
* Добавить автоматические тесты и CI-скрипты.
* Реализовать поддержку внешних файлов конфигурации.

---

## Требования

Для работы необходим действующий **API-key ChatGPT**.
Сейчас ключ хранится в текстовом файле по пути `C:/API_keys/API_key_GPT.txt`. Подключить его можно так:

```python
import os

API_KEY_PATH = os.path.join("C:\\", "API_keys", "API_key_GPT.txt")
with open(API_KEY_PATH, "r") as f:
    OPENAI_API_KEY = f.read().strip()
```

Также можно прописать ключ напрямую в `infra/config.py`:

```python
OPENAI_API_KEY = "ваш_api_ключ"
```

**Рекомендация:** хранить ключ в переменной окружения и подключать его в `config.py`, чтобы не хранить секреты в коде:

```python
import os
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
```
